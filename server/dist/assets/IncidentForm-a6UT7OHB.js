import{r as s,G as I,j as e}from"./index-DHdrx00N.js";import{a as E}from"./axios-C8DqakIB.js";import{u as R,M as q,T as A,a as B}from"./leaflet-DOuSLvSV.js";import{M as H}from"./index-DTIixIdq.js";function $(){return R().map}function O(l){const n=$();return s.useEffect(function(){return n.on(l),function(){n.off(l)}},[n,l]),n}const P="http://localhost:3000",te=()=>{const[l,n]=s.useState(""),[d,p]=s.useState("mistreatment"),[b,u]=s.useState(""),[f,x]=s.useState(""),[o,y]=s.useState(null),[a,g]=s.useState(null),{user:m,token:S}=I(),[w,X]=s.useState(S),[j,N]=s.useState("");s.useEffect(()=>{m&&N(m.userName)},[m]);const C=()=>{navigator.geolocation.getCurrentPosition(t=>{y(t.coords.latitude),g(t.coords.longitude)})},k=()=>{u(new Date().toISOString().split("T")[0])},M=()=>{x(new Date().toTimeString().split(" ")[0].slice(0,5))},T=()=>(O({click:t=>{y(t.latlng.lat),g(t.latlng.lng)}}),null),D=async t=>{if(t.preventDefault(),o===null||a===null){alert("Please select a valid location on the map.");return}const L={name:j,description:l,category:d,date:b,time:f,location:{type:"Point",coordinates:[a,o]}};try{const h={headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}},z=await E.post(`${P}/api/incidents/addIncident`,L,h);console.log("Incident saved:",z.data)}catch(h){console.error("Error saving incident:",h)}n(""),p("mistreatment"),u(""),x(""),y(null),g(null)};return e.jsxs("div",{style:F,className:"",children:[e.jsxs("div",{style:G,className:"bg-white shadow-lg",children:[e.jsx("h2",{style:{textAlign:"center"},className:"text-gray-900 text-xl m-3",children:"Report an Incident"}),e.jsxs("form",{onSubmit:D,style:J,children:[e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,children:"Name"}),e.jsx("input",{type:"text",value:j,readOnly:!0,style:c,className:"bg-gray-800 focus:bg-gray-900 outline-none border border-white focus:border-pink-400"})]}),e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,children:"Description"}),e.jsx("textarea",{value:l,onChange:t=>n(t.target.value),required:!0,style:K,className:"bg-gray-800 focus:bg-gray-900 outline-none border border-white "})]}),e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,children:"Category"}),e.jsxs("select",{value:d,onChange:t=>p(t.target.value),required:!0,style:c,className:"bg-gray-800 focus:bg-gray-900",children:[e.jsx("option",{value:"mistreatment",children:"Mistreatment"}),e.jsx("option",{value:"hooligans",children:"Hooligans"}),e.jsx("option",{value:"cat-calling",children:"Cat-calling"}),e.jsx("option",{value:"shady-area",children:"Shady Area"})]})]}),e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,children:"Date"}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{type:"date",value:b,onChange:t=>u(t.target.value),required:!0,style:{...c,flex:"1"},className:"bg-gray-800 focus:bg-gray-900"}),e.jsx("button",{type:"button",onClick:k,style:v,className:"bg-pink-500",children:"Today"})]})]}),e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,children:"Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{type:"time",value:f,onChange:t=>x(t.target.value),required:!0,style:{...c,flex:"1"},className:"bg-gray-800 focus:bg-gray-900"}),e.jsx("button",{type:"button",onClick:M,style:v,className:"bg-pink-500",children:"Now"})]})]}),e.jsxs("div",{style:i,children:[e.jsx("label",{style:r,className:"",children:"Location"}),e.jsxs("button",{type:"button",onClick:C,style:Q,className:"bg-pink-500",children:["Detect My Location",e.jsx(H,{className:"inline-block mx-1 text-xl hover:bg-pink-600"})]}),e.jsx("p",{style:W,className:" text-xs m-0 mt-1",children:o&&a?`Latitude: ${o}, Longitude: ${a}`:"Click on the map to set a location"})]}),e.jsx("button",{type:"submit",disabled:!o||!a,style:V,className:"bg-pink-600",children:"Submit"})]})]}),e.jsx("div",{style:U,children:e.jsxs(q,{center:[29.95488,76.819534],zoom:13,style:{height:"100%",width:"100%"},children:[e.jsx(A,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"Â© <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors"}),e.jsx(T,{}),o&&a&&e.jsx(B,{position:[o,a]})]})})]})},F={display:"flex",flexDirection:"row",paddingTop:"40px",height:"100vh",width:"100vw",position:"relative",zIndex:"1"},G={flex:2,padding:"20px",color:"#fff"},U={flex:5,borderRadius:"8px",overflow:"hidden"},J={display:"flex",flexDirection:"column",gap:"15px"},i={display:"flex",flexDirection:"column"},r={fontSize:"10px",marginBottom:"5px",color:"#555"},K={padding:"10px",fontSize:"14px",borderRadius:"4px",height:"100px"},v={padding:"5px 10px",fontSize:"14px",borderRadius:"4px",color:"white",border:"none",cursor:"pointer",marginLeft:"10px"},c={padding:"10px",fontSize:"10px",borderRadius:"4px",border:"1px solid #ccc",flex:"1"},Q={padding:"8px",fontSize:"9px",borderRadius:"4px",color:"white",border:"none",cursor:"pointer"},V={padding:"10px 20px",fontSize:"16px",borderRadius:"4px",color:"white",border:"none",cursor:"pointer",marginTop:"10px"},W={color:"#777"};export{te as default};
